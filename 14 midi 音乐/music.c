#include<reg52.h>        //?????????????????????????   
                         //???????????????????????   
/*------------------------------------------------  
                 ?????????  
------------------------------------------------*/   
sbit      SPK=P1^5;  //??????????????   
   
unsigned char Timer0_H,Timer0_L,Time;   
                         //?????????????????   
code unsigned char MUSIC[]={          6,1,1,      7,1,1,      1,2,3,    7,1,1,    1,2,2,    3,2,2,    7,1,6,   
                                      3,1,1,      3,1,1,      6,1,3,    5,1,1,    6,1,2,    1,2,2,    5,1,6,   
                                      3,1,2,      4,1,3,      3,1,1,    4,1,2,    1,2,2,    3,1,4,    1,2,1,   
                                      1,2,1,      1,2,1,      7,1,3,    4,1,1,    4,1,2,    7,1,2,    7,1,4,   
                                      6,1,1,      7,1,1,      1,2,3,    7,1,1,    1,2,2,    3,2,2,    7,1,6,   
                                      };   
                         // ???????? ???¦Ë   
code unsigned char FREQH[]={   
                                0xF2,0xF3,0xF5,0xF5,0xF6,0xF7,0xF8,    
                                0xF9,0xF9,0xFA,0xFA,0xFB,0xFB,0xFC,0xFC, //1,2,3,4,5,6,7,8,i   
                                0xFC,0xFD,0xFD,0xFD,0xFD,0xFE,   
                                0xFE,0xFE,0xFE,0xFE,0xFE,0xFE,0xFF,   
                               } ;   
                         // ???????? ???¦Ë   
code unsigned char FREQL[]={   
                                 0x42,0xC1,0x17,0xB6,0xD0,0xD1,0xB6,   
                                 0x21,0xE1,0x8C,0xD8,0x68,0xE9,0x5B,0x8F, //1,2,3,4,5,6,7,8,i   
                                 0xEE,0x44, 0x6B,0xB4,0xF4,0x2D,    
                                 0x47,0x77,0xA2,0xB6,0xDA,0xFA,0x16,   
                                };   
/*------------------------------------------------  
 uS???????????????????? unsigned char t????????  
 unsigned char ?????????????????????????¦¶??  
 0~255 ??????t???12M???????????????,???????  
 ???????? T=tx2+5 uS   
------------------------------------------------*/   
void DelayUs2x(unsigned char t)   
{      
 while(--t);   
}   
/*------------------------------------------------  
 mS???????????????????? unsigned char t????????  
 unsigned char ?????????????????????????¦¶??  
 0~255 ??????t???12M???????????????  
------------------------------------------------*/   
void DelayMs(unsigned char t)   
{   
        
 while(t--)   
 {   
     //???????1mS   
     DelayUs2x(200);   
     DelayUs2x(200);   
 }   
}   
/*------------------------------------------------  
                ???????????  
 ????1/4???????  
 ??4/4  125ms  
 ??2/4  250ms  
 ??3/4  187ms  
------------------------------------------------*/   
void delay(unsigned char t)   
{   
    unsigned char i;   
    for(i=0;i<6*t;i++)   
        DelayMs(50);   
    TR0=0;   
 }   
/*------------------------------------------------  
               ?????0?§Ø?  
------------------------------------------------*/   
void TIM0_ISR() interrupt 1   
{   
 TR0=0;         
 SPK=!SPK;   
 TH0=Timer0_H;   
 TL0=Timer0_L;   
 TR0=1;   
 }   
/*------------------------------------------------  
                ????????????  
------------------------------------------------*/   
void Song()   
{   
 TH0=Timer0_H;//??????????????????   
 TL0=Timer0_L;   
 TR0=1;       //???????   
 delay(Time); //?????????????                         
 }   
/*------------------------------------------------  
                ??????  
------------------------------------------------*/   
 void main(void)   
 {   
 unsigned char k,i;   
 TMOD|=0x01; //??????0???????1   
 EA=1;       //??????§Ø?   
 ET0=1;      //?????0?§Ø?   
 while(1)   
      {   
       i=0;     
       while(i<100)   
            {         //???????øA?? ????????????           
            k=MUSIC[i]+7*MUSIC[i+1]-1;//??????????????????   
            Timer0_H=FREQH[k];   
            Timer0_L=FREQL[k];   
            Time=MUSIC[i+2];          //???????   
            i=i+3;   
            Song();   
           }   
       }    
  }   
   

 
//
//#include <REG51.H>
//#define uchar unsigned char
//sbit beepIO=P1^5;
//uchar m,n; 
//uchar code T[49][2]={{0,0},
//{0xF8,0x8B},{0xF8,0xF2},{0xF9,0x5B},{0xF9,0xB7},{0xFA,0x14},{0xFA,0x66},{0xFA,0xB9},{0xFB,0x03},{0xFB,0x4A},{0xFB,0x8F},{0xFB,0xCF},{0xFC,0x0B},
//{0xFC,0x43},{0xFC,0x78},{0xFC,0xAB},{0xFC,0xDB},{0xFD,0x08},{0xFD,0x33},{0xFD,0x5B},{0xFD,0x81},{0xFD,0xA5},{0xFD,0xC7},{0xFD,0xE7},{0xFE,0x05},
//{0xFE,0x21},{0xFE,0x3C},{0xFE,0x55},{0xFE,0x6D},{0xFE,0x84},{0xFE,0x99},{0xFE,0xAD},{0xFE,0xC0},{0xFE,0x02},{0xFE,0xE3},{0xFE,0xF3},{0xFF,0x02},
//{0xFF,0x10},{0xFF,0x1D},{0xFF,0x2A},{0xFF,0x36},{0xFF,0x42},{0xFF,0x4C},{0xFF,0x56},{0xFF,0x60},{0xFF,0x69},{0xFF,0x71},{0xFF,0x79},{0xFF,0x81}
//};
//uchar code music[][2]={{0,4},
//{22,4},{24,4},{25,12},{24,4},{25,8},{29,8},{24,24},{17,4},{17,4},{22,12},{20,4},{22,8},{25,8},{20,16},{0,8},{17,4},{17,4},
//{0xFF,0xFF}};
//
//void delay(uchar p)
//{
//    uchar i,j; 
//    for(;p>0;p--)
//    for(i=181;i>0;i--)
//    for(j=181;j>0;j--);
//}
//
//void pause()
//{
//    uchar i,j;
//    for(i=150;i>0;i--)
//    for(j=150;j>0;j--);
//}
//
//void T0_int() interrupt 1
//{
// beepIO=!beepIO;
// TH0=T[m][0]; TL0=T[m][1];
//}
//
//void main()
//{
// uchar i=0; 
// TMOD=0x01;  EA=1; ET0=1; 
// while(1) 
//      {
//        m=music[i][0];n=music[i][1]; 
//           if(m==0x00)
//             {TR0=0;delay(n);i++;} 
//           else if(m==0xFF)
//             {TR0=0;delay(30);i=0;} 
//           else if(m==music[i+1][0]) 
//             {TR0=1;delay(n);TR0=0;pause();i++;}
//           else
//             {TR0=1;delay(n);i++;}
//      }
//}